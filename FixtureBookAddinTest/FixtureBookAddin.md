FixtureBookAddin 2.0
====================
FixtureBook Excel アドイン

事前準備
--------
### 事前準備

1.  Excel を起動し、リボンに `FixtureBook` が無いことを確認する [*]
1.  Excel を終了する
1.  `C:\Users\Owner\AppData\Roaming\XPFriend\FixtureBook` フォルダを削除する


インストール
------------
### インストール機能
install.bat でアドインのインストールが出来る

1.  install.bat を実行する
1.  Excel を起動すると、リボンに `FixtureBook` が追加されていること [*]


シート編集機能
--------------
### 新規シート作成
Excelシートを新規作成できる

1.  リボンから「追加 - シート」を選ぶと、シートを新規作成できること。
1.  再度、リボンから「追加 - シート」を選ぶと、シートをもうひとつ新規作成できること。

### テストケース追加
既存シートにテストケースを追加できる

1.  シート下方のテストケース記述がない部分にカーソルを移動し、
    リボンから「テストケース追加」を選ぶと、テストケースを既存シートに追加できること。
    *   この場合、新規テストケースはシートの最後尾に追加されること
    *   追加したテストケースの先頭が表示されカーソルが追加テストケース名付近に移動していること
1.  テストケース記述の内部にカーソルを移動し、テストケース追加しても、テストケースを既存シートに追加できること。
    *   この場合、現在カーソルがある位置にあるテストケースの次に新規テストケースが追加されること
    *   追加したテストケースの先頭が表示されカーソルが追加テストケース名付近に移動していること
1.  A1セル（空行）にカーソルを移動し、テストケース追加しても、テストケースを既存シートに追加できること。
    *   この場合、シートの先頭に新規テストケースが追加されること
1.  1行目を削除し、1行目に「A. テストケース」がある状態にして、
    テストケース追加しても、テストケースを既存シートに追加できること。
    *   この場合、２番目のテストケースとして新規テストケースが追加されること
1.  シートの最終行にカーソルを移動し、テストケース追加した場合、何も起こらないこと（無視されること）。

### テーブル追加（雛形コピー）
既存シートに雛形通りのテーブルを追加できる

1.  データベース設定ファイル(db.config)が存在しないことを確認する。
1.  カーソルを「A.テストケース」の行に移動し、「追加 - テーブル」を選ぶと何も起こらないこと。
1.  カーソルを「B. テストデータクリア条件」の行に移動し、「追加 - テーブル」を選ぶとクリア条件テーブル定義が追加されること。
    *   新規テーブル定義は、2つめに追加されること。
1.  カーソルを「B. テストデータクリア条件」の次の行に移動し、「追加 - テーブル」を選ぶとクリア条件テーブル定義が追加されること。
    *   新規テーブル定義は、2つめに追加されること。
1.  カーソルを「C. テストデータ」の行に移動し、「追加 - テーブル」を選ぶとテストデータテーブル定義が追加されること。
1.  カーソルを「D. パラメタ」の行に移動し、「追加 - テーブル」を選ぶとパラメタテーブル定義が追加されること。
1.  カーソルを「E. 取得データ」の行に移動し、「追加 - テーブル」を選ぶと取得データテーブル定義が追加されること。
1.  カーソルを「F. 更新後データ」の行に移動し、「追加 - テーブル」を選ぶと更新データテーブル定義が追加されること。


### テーブル追加（データ取得）とセットアップ
既存シート上のデータをデータベースに登録でき、データベースから取得したデータでExcelシート上にテーブル追加できる

1.  以下の手順で事前にデータベース設定を行っておくこと
    1.  設定画面を開き、名前に `Oracle` と入力し、`Oracle.DataAccess.Client`（Oracle 用のプロバイダ）を選択し、接続文字列を記述する。
    1.  「追加」をクリックし、`SQLServer` と入力し、`System.Data.SqlClient`（SQLServer 用のプロバイダ）を選択して、「設定保存」をクリックする。
1.  カーソルを「C. テストデータ」の行に移動し、「追加 - テーブル」を選ぶとクエリーウインドウが開くこと
1.  クエリーウインドウでは以下の項目が表示されていること [*]
    *   データベーステーブル名の一覧 : 実際にテーブルが一覧表示されている
    *   SQL入力用テキストフィールド : 未入力
    *   取得件数 : 10
    *   「クエリー実行」、「キャンセル」ボタン
1.  クエリーウインドウは以下の動作をすること
    *   データベーステーブル名一覧からテーブル名を選択すると
        SQL入力用テキストフィールドに `select * from table_name`
        という SQL が追加されること
    *   最大取得件数は最大 999 まで入力可能なこと
    *   最大取得件数には数値以外は入力できないようになっていること
1.  クエリーウインドウをいったん閉じてから再度開き、テーブルを選択せずに、
    SQL入力用テキストフィールドを未入力のまま「クエリー実行」ボタンをクリックするとウインドウがクローズする
1.  FixtureBookAddinTest.xls の 「SQLServer」シート、テストケース「1000件データ」の所にカーソルを合わせ、
    「実行 - セットアップ」をクリックする
1.  クエリーウインドウで取得件数に999と入力し、`TypesTable`を選択し、「クエリー実行」をクリックすると、
    999件のデータが取得される
1.  クエリーウインドウで取得件数に10と入力し、`TypesTable`を選択し、「クエリー実行」をクリックすると、
    10件のデータが取得される
1.  クエリーウインドウで取得件数に1と入力し、`TypesTable`を選択し、「クエリー実行」をクリックすると、
    2件のデータが追加され、1件目にDBから取得したデータが表示される
1.  クエリーウインドウで取得件数に0と入力し、`TypesTable`を選択し、「クエリー実行」をクリックすると、
    2件のデータが追加され、1件目にDBから取得したデータが表示される
1.  クエリーウインドウで取得件数を空白にして、`TypesTable`を選択し、「クエリー実行」をクリックすると、
    10件のデータが追加される
1.  FixtureBookAddinTest.xls の 「SQLServer」シート、テストケース「0件データ」の所にカーソルを合わせ、
    「実行 - セットアップ」をクリックする
1.  クエリーウインドウで `TypesTable`を選択し、「クエリー実行」をクリックすると、
    2件のデータが追加され、DBから取得したデータとしては何も表示されない。
1.  FixtureBookAddinTest.xls の 「SQLServer」シート、テストケース「1件データ」の所にカーソルを合わせ、
    「実行 - セットアップ」をクリックする
1.  クエリーウインドウで `TypesTable`を選択し、「クエリー実行」をクリックすると、
    2件のデータが追加され、1件目にDBから取得したデータが表示される
1.  FixtureBookAddinTest.xls の 「SQLServer」シート、テストケース「2件データ」の所にカーソルを合わせ、
    「実行 - セットアップ」をクリックする
1.  クエリーウインドウで `TypesTable`を選択し、「クエリー実行」をクリックすると、
    2件のデータが追加され、1件目, 2件目にDBから取得したデータが表示される
1.  FixtureBookAddinTest.xls の 「SQLServer」シート、テストケース「3件データ」の所にカーソルを合わせ、
    「実行 - セットアップ」をクリックする
1.  クエリーウインドウで `TypesTable`を選択し、「クエリー実行」をクリックすると、
    3件のデータが追加され、1件目, 2件目, 3件目にDBから取得したデータが表示される
1.  FixtureBookAddinTest.xls の 「Oracle」シート、テストケース「1000件データ」の所にカーソルを合わせ、
    「実行 - セットアップ」をクリックする
1.  設定画面で名前を「Oracle」に変更する。
1.  クエリーウインドウで `TYPES_TABLE`を選択し、「クエリー実行」をクリックすると、
    10件のデータが追加されること
1.  カーソルを「F. 更新後データ」の行に移動し、「追加 - テーブル」を選ぶと、クエリーウインドウが開き、
    検索結果でテーブル記述が追加されること。

### テーブル追加（空欄データベース設定）
1.  事前にデータベース設定画面のプロバイダ名で空欄を選択しておくこと
1.  カーソルを「C. テストデータ」の行に移動し、「追加 - テーブル」を選ぶとテストデータテーブル定義が追加されること。
1.  カーソルを「F. 更新後データ」の行に移動し、「追加 - テーブル」を選ぶと更新データテーブル定義が追加されること。


設定機能
--------
### データベース接続設定画面
1.  データベース設定ファイル(db.config)を削除し、Excel を再起動する。
1.  リボンから「設定 - データベース」を選ぶと、データベース接続画面が開くこと。  
    データベース接続設定画面では以下の項目が表示されていること [*]
    *   名前:Connection1
    *   プロバイダ名:空欄
    *   プロバイダ名:リスト上には空欄、`System.Data.SqlClient`、`Oracle.DataAccess.Client`
        の3行が表示されていること
    *   接続文字列:空欄
    *   「追加」、「削除」、「設定保存」、「キャンセル」ボタン
    *   「削除」ボタンは非活性
1.  プロバイダ名で `System.Data.SqlClient` を選択すると、
    `Data Source=(LocalDB)\v11.0;integrated security=True;Initial Catalog=test1";` が接続文字列に表示されること [*]
1.  プロバイダ名で `Oracle.DataAccess.Client` を選択すると、
    `User Id=scott;Password=tiger;Data Source=xe` が接続文字列に表示されること [*]
1.  プロバイダ名で空欄を選択すると、接続文字列も空欄になること [*]
1.  プロバイダ名で `System.Data.SqlClient` を選択し、「設定保存」ボタンをクリックすると画面が閉じること。
1.  設定画面を開くとプロバイダ名が `System.Data.SqlClient`、
    接続文字列が `Data Source=(LocalDB)\v11.0;integrated security=True;Initial Catalog=test1";` になっていること [*]
1.  プロバイダ名で `Oracle.DataAccess.Client` を選択し、
    わざと存在しないユーザー名を設定し、「設定保存」ボタンをクリックすると、
    入力された設定で接続できるかどうかのチェックがエラーになり、エラーメッセージが表示されること [*]
    この際画面は閉じないこと。
1.  キャンセルボタンをクリックすると画面が閉じること。
1.  設定画面を開くとプロバイダ名が `System.Data.SqlClient`、
    接続文字列が `Data Source=(LocalDB)\v11.0;integrated security=True;Initial Catalog=test1";` になっていること [*]
1.  プロバイダ名で空欄を選択し、「設定保存」をクリックし、再度設定画面を開くと、
    プロバイダ名、接続文字列ともに空欄となっていること [*]
1.  プロバイダ名で `Oracle.DataAccess.Client` を選択し、
    接続文字列のユーザーID、パスワードを実際に存在するものに変更して
    「設定保存」ボタンをクリックすると、画面が閉じること。
1.  設定画面を再度開き、「名前」を `Oracle` に変更する。
1.  「追加」ボタンをクリックすると、名前入力用の画面が開くが、そのままウインドウをクローズすると名前リストに名前は追加されない。
1.  「追加」ボタンをクリックすると、名前入力用の画面が開くが、そのまま「追加」をクリックすると名前リストに名前は追加されない。
1.  「追加」ボタンをクリックすると、名前入力用の画面が開くが、「名前」に `Oracle` と入力して「追加」をクリックしても名前リストに名前は追加されない。
1.  「追加」ボタンをクリックすると、名前入力用の画面が開くので、「名前」に `SQLServer`
    と入力して「追加」をクリックすると、名前リストに `SQLServer` が追加され、プロバイダ名、接続文字列ともに空欄となっている。
1.  「設定保存」ボタンをクリックして画面を閉じ、再度開くと、`SQLServer` が表示され、プロバイダ名、接続文字列ともに空欄となっていること。
1.  `Oracle` を選択すると、プロバイダ名、接続文字列が以前設定されたものに変更されること。
1.  「削除」ボタンをクリックすると、`SQLServer` が表示され、名前リストから `Oracle` が消え、削除ボタンが非活性になること。



アンインストール
----------------
### アンインストール機能
uninstall.bat でアドインのアンインストールが出来る

1.  Excel を終了し、uninstall.bat を実行する
1.  Excel を起動すると、リボンから `FixtureBook` が消えている


ドキュメント
------------
### README.txt

1.  README.txt のダウンロードURLが
    `http://xpfriend.com/fixture-book/FixtureBookAddin-2.1.zip`
    となっていること [*]
